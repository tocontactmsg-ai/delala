<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ù„Ø¯Ù„Ø§Ù„Ø© | Ø³ÙˆÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡ ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</title>
<link rel="icon" type="image/png" href="/favicon.ico">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-VFM8VZCQY6');
</script>

  <meta name="description" content="Ø§Ù„Ø¯Ù„Ø§Ù„Ø© â€” Ù…Ø¹Ø±Ø¶ ÙˆØ³ÙˆÙ‚ Ù…ØªÙ…ÙŠØ² Ù„Ù†Ø´Ø± ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙˆØ¨Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆÙŠØ³Ø± ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† . Ø§Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ Ù…Ø¨Ø§Ø´Ø±Ø© , Ù…ØªØ¹Ø© ÙˆØ³Ù‡ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø·Ù„Ø¨ ,ÙÙ‚Ø· Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø§Ø¹Ù„Ø§Ù† ÙˆØ§Ø°Ø§ ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø³ÙŠØ¹Ø±Ø¶ Ø§Ø¹Ù„Ø§Ù†Ùƒ Ø¹Ù„ÙŠ Ø§Ù„Ù…Ù„Ø§ÙŠÙŠÙ† Ù…Ù† Ø§Ù„Ø²ÙˆØ§Ø±." />
<link rel="canonical" href="https://eldelala.com/" />
<link rel="icon" type="image/png" href="/favicon.ico">

<meta property="og:type" content="website" />
<meta property="og:title" content="Ø§Ù„Ø¯Ù„Ø§Ù„Ø© â€” Ø§Ø¹Ù„Ù† Ø¨Ø¨Ø³Ø§Ø·Ø© ÙˆØ³Ù‡ÙˆÙ„Ø©" />
<meta property="og:description" content="Ø³ÙˆÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† â€“ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©" />
<meta property="og:url" content="https://eldelala.com/" />
<meta property="og:image" content="https://eldelala.com/logo-1200x630.png" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Ø§Ù„Ø¯Ù„Ø§Ù„Ø© â€” Ø³ÙˆÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† â€“ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©" />
<meta name="twitter:description" content="Ø³ÙˆÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† â€“ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©" />
<meta name="twitter:image" content="https://eldelala.com/logo-800x418.png" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": ["WebSite", "Organization"],
  "name": "Ø§Ù„Ø¯Ù„Ø§Ù„Ø©",
  "url": "https://eldelala.com/",
  "logo": "https://eldelala.com/logo.png",
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "+249-9986-15193",
    "contactType": "customer support",
    "email": "info@eldelala.com"
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://eldelala.com/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<link rel="preload" href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet"></noscript>

<style>
  /* --- EXISTING STYLES --- */
  *{box-sizing:border-box;font-family:"Tajawal",sans-serif}
  body{margin:0;background:#f7fbff;color:#0b1320;line-height:1.4}
  .container{max-width:1100px;margin:16px auto;padding:12px}
  header{background:#0078d7;color:#fff;padding:12px;border-radius:14px;box-shadow:0 12px 40px rgba(0,120,215,0.35);margin-bottom:16px}
  header .brand{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
  .brand .title{font-size:24px;font-weight:900; cursor:pointer;} /* ğŸ’¡ Added cursor:pointer for logo */
  nav[aria-label="ÙˆØ§Ø¬Ù‡Ø©"]{display:flex;gap:8px;flex-wrap:wrap}
  nav[aria-label="ÙˆØ§Ø¬Ù‡Ø©"] button{
    background:rgba(255,255,255,0.12);
    color:#fff;
    border:1px solid rgba(255,255,255,0.4);
    padding:6px 10px;
    border-radius:999px;
    cursor:pointer;
    font-size:13px;
  }
  nav[aria-label="ÙˆØ§Ø¬Ù‡Ø©"] button[aria-current="true"]{
    background:#fff;
    color:#0078d7;
    border-color:#fff;
  }

  .controls{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0;align-items:center}
  input, textarea, select{
    padding:10px;border-radius:10px;border:1px solid #e6eef8;width:100%;font-size:15px;background:#fff
  }
  textarea{min-height:80px;resize:vertical}
  .btn{background:#0078d7;color:#fff;padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-size:14px}
button.btn.alt#modalClose {
  background: red; /* or background-color: #FF0000; */
}
    .btn{background:#0078d7;color:#fff;padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-size:14px}
button.btn.alt#modalCall {
  background: blue; /* or background-color: #FF0000; */
}
  .btn.alt{background:green }
  .btn[disabled]{opacity:.5;cursor:not-allowed}

  .grid{display:grid;grid-template-columns:repeat(1,1fr);gap:14px}
  @media (min-width:560px){ .grid{grid-template-columns:repeat(2,1fr)} }
  @media (min-width:900px){ .grid{grid-template-columns:repeat(3,1fr)} }
  .card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(15,23,42,0.09);display:flex;flex-direction:column;transition:transform .12s;cursor:pointer}
  .card:hover{transform:translateY(-4px)}
  .media{height:220px;background:#f0f4f8;display:flex;align-items:center;justify-content:center;position:relative}
  .media img{width:100%;height:100%;object-fit:cover;display:block}
  .body{padding:12px;display:flex;flex-direction:column;gap:8px;flex:1}
  .title{font-weight:700;font-size:16px}
  .desc{font-size:13px;color:#4b5563;max-height:3.6em;overflow:hidden}
  .meta{display:flex;justify-content:space-between;align-items:center;font-size:12px;color:#6b7280}
  .badge{background:#eff6ff;color:#1d4ed8;padding:4px 8px;border-radius:999px;font-size:11px}
  .price{font-weight:700;color:#047857}
  footer{font-size:12px;color:#6b7280;text-align:center;margin-top:18px}
  .small{font-size:12px}
  .muted{color:#6b7280}
  .panel{background:#fff;border-radius:14px;padding:12px;box-shadow:0 8px 24px rgba(15,23,42,0.08);margin-top:8px}
  .subCard{background:#0f172a;color:#e5e7eb;border-radius:14px;padding:10px;margin-top:10px}
  .refBox{background:#eff6ff;border-radius:10px;padding:6px 8px;display:flex;justify-content:space-between;align-items:center;gap:8px}
  .refCode{font-family:monospace;font-size:16px;font-weight:800}
  .fullDesc{white-space:pre-wrap;font-size:14px;color:#111827}
  .detailsList{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px;margin-top:8px}
  .detailsItem{background:#f9fafb;border-radius:10px;padding:6px 8px;font-size:13px}
  .detailsItem strong{display:block;font-size:11px;color:#6b7280;margin-bottom:2px}
/* ÙŠÙ…Ù†Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† ØªØºØ·ÙŠØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© */
.modalMain{
  max-height: calc(90vh - 80px);
  overflow-y: auto;
}

.modalImage{
  max-height: 60vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modalImage img{
  max-height: 55vh; /* ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ…Ø¯Ø¯ Ø§Ù„Ø²Ø§Ø¦Ø¯ */
  width: auto;
  height: auto;
  object-fit: contain;
}

  main > section{display:none}
  main > section.active{display:block}

  .modal{position:fixed;inset:0;background:rgba(15,23,42,0.6);display:none;align-items:center;justify-content:center;z-index:999;padding:12px}
  .modal[aria-hidden="false"]{display:flex}
  .modalCard{background:#fff;border-radius:18px;max-width:900px;width:100%;max-height:90vh;overflow:hidden;box-shadow:0 18px 40px rgba(15,23,42,0.5);display:flex;flex-direction:column}
  .modalMain{display:grid;grid-template-columns:minmax(0,1.1fr) minmax(0,1.1fr);gap:12px;padding:12px}
  .modalImage{background:#020617;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .modalImage img{max-width:100%;max-height:360px;display:block}
  .modalFooter{padding:10px 12px;border-top:1px solid #e5e7eb;background:#f9fafb;font-size:12px;color:#6b7280;display:flex;justify-content:space-between;gap:8px;align-items:center}
  .modalActions{display:flex;gap:8px;flex-wrap:wrap}

  @media(max-width:720px){
    .modalMain{grid-template-columns:1fr}
    .modalImage{order:-1}
    .detailsList{grid-template-columns:1fr}
  }

/* --- Ticker Tape / Marquee Bar Styles --- */
#tickerTape{
  background: #fffae8; /* Soft yellow background for attention */
  border: 1px solid #ffcc00;
  padding: 8px 12px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  overflow: hidden;
  margin-bottom: 16px;
  display: none; /* ğŸ›‘ Hidden by default */
}
#tickerTape.has-messages {
    display: flex; /* ğŸ›‘ Only shown if JS adds the class */
}
.ticker-content{
  display: flex;
  white-space: nowrap; /* Keep content on a single line */
  animation: marquee-rtl 25s linear infinite; /* Animation definition */
}
.ticker-content:hover{
  animation-play-state: paused; /* Pause on hover */
}
.ticker-item{
  font-size: 14px;
  color: #333;
  padding-left: 50px; /* Space between messages */
  font-weight: 500;
  display: inline-flex;
  align-items: center;
}
/* RTL Marquee Animation */
@keyframes marquee-rtl {
  100% { transform: translateX(100%); } /* Start off-screen right */
   0% { transform: translateX(-100%); } /* End off-screen left */
}
/* Ensure the items don't stretch */
.ticker-item:first-child {
  padding-left: 0;
}
/* --- End Ticker Tape Styles --- */

/* ========================================================== */
/* ğŸ’¡ NEW: MESSAGE CONTAINER STYLING (MSEGS) */
/* ========================================================== */
:root {
    /* Eldelala Primary Colors for Messages */
    --msg-primary-color: #0078d7; /* Header Blue */
    --msg-text-color: #0b1320;
    --msg-bg-color: #f7fbff;
    
    /* Success Message Colors (Calm Green) */
    --success-bg: #e6ffed; /* Very light green */
    --success-border: #047857; /* Price Green */
    --success-text: #059669; 
    
    /* Error/Warning Message Colors (Orange/Red - Using Alt Button color as a base for error) */
    --error-bg: #fee2e2;
    --error-border: #dc2626;
    --error-text: #dc2626;
}

#msges-container {
    width: 100%;
    max-width: 1100px; /* Matching the container width */
    margin: 0 auto 16px auto; /* Margin above controls, below header */
    padding: 0 12px;
    display: none; /* Controlled by JS: disappears when empty */
}

.msges-box {
    display: flex; 
    align-items: center;
    
    margin-bottom: 8px;
    padding: 14px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    font-size: 14px;
    line-height: 1.5;
    text-align: right; 
}

/* Success Message Style */
.msges-box.success {
    background-color: var(--success-bg);
    color: var(--success-text);
    /* RTL Border on the right */
    border-right: 5px solid var(--success-border); 
}

/* Error Message Style */
.msges-box.error {
    background-color: var(--error-bg);
    color: var(--error-text);
    border-right: 5px solid var(--error-border); 
}

/* Close Button Styling */
.close-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.3rem;
    font-weight: bold;
    color: inherit; 
    /* Push button to the far left in RTL layout */
    margin-inline-start: auto; 
    padding: 0 10px;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.close-btn:hover {
    opacity: 1;
}
/* ========================================================== */
/* ğŸ›‘ END OF NEW MESSAGE STYLES */
/* ========================================================== */

/* ========================================================== */
/* ğŸ’¡ NEW: ADMIN PANEL STYLES */
/* ========================================================== */
  /* Add styles for the admin panel and stats */
  .grid-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 12px;
    margin-top: 15px;
  }
  .stat-card {
    background: #f0f4f8;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  .stat-card strong {
    display: block;
    font-size: 28px;
    color: #0078d7;
    margin-bottom: 4px;
  }
  .stat-card span {
    font-size: 14px;
    color: #4b5563;
  }

  /* Admin List/Table Styling (Responsive) */
  .admin-list-container {
    margin-top: 10px;
    overflow-x: auto; /* Allow horizontal scroll on small screens */
  }

  .admin-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 8px; /* Space between rows */
    min-width: 650px; /* Ensure table is usable on small screens */
  }
  .admin-table th, .admin-table td {
    padding: 12px;
    text-align: right;
    font-size: 13px;
    vertical-align: middle;
  }
  .admin-table th {
    background: #e6eef8;
    color: #0b1320;
    font-weight: 700;
    position: sticky; /* Keep header visible on horizontal scroll */
    top: 0;
    z-index: 10;
  }
  .admin-table thead tr th:first-child { border-radius: 8px 0 0 0; }
  .admin-table thead tr th:last-child { border-radius: 0 8px 0 0; }

  .admin-table tbody tr {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    transition: transform 0.1s;
    cursor: default;
  }
  .admin-table tbody tr:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }

  .admin-table .action-btns {
    display: flex;
    gap: 6px;
    flex-wrap: nowrap;
    justify-content: flex-end; /* Align buttons to the left (RTL) */
  }
  .admin-table .action-btns button {
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    border: none;
    cursor: pointer;
  }
  .admin-table .delete-btn { background: #dc2626; color: #fff; }
  .admin-table .edit-btn { background: #f59e0b; color: #fff; }
  .admin-table .approve-btn { background: #059669; color: #fff; }

/* Edit Ad Form inside Modal */
#edit-ad-form input, #edit-ad-form textarea, #edit-ad-form select {
    margin-bottom: 8px;
    border-radius: 6px;
    padding: 8px;
    font-size: 14px;
}
#edit-ad-form textarea {
    min-height: 60px;
}
/* ========================================================== */
/* ğŸ›‘ END OF NEW ADMIN PANEL STYLES */
/* ========================================================== */
</style>
</head>
<body>
<div class="container" id="app">
  <header>
    <div class="brand">
      <div class="title">Ø§Ù„Ø¯Ù„Ø§Ù„Ø©</div>
      <nav aria-label="ÙˆØ§Ø¬Ù‡Ø©">
        <button type="button" class="nav-btn" data-target="home" aria-current="true">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button type="button" class="nav-btn" data-target="send">Ø£Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ</button>
        <button type="button" class="nav-btn" data-target="privacy">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</button>
        <button type="button" class="nav-btn" data-target="admin" id="adminNavBtn" style="display:none;">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</button>
      </nav>
    </div>
  </header>
  
  <div id="msges-container">
    </div>
  <div class="controls" id="listControls" role="search" aria-label="Ø¨Ø­Ø« ÙˆØªØ­ÙƒÙ…">
    <div style="flex:1;min-width:180px"><input id="q" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„Ø±Ù…Ø² Ø£Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹"></div>
    <div style="width:200px"><select id="catFilter"><option value="">ÙƒÙ„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…</option></select></div>
    <div style="display:flex;gap:8px;align-items:center">
      <div id="count" class="small" aria-live="polite">ØªØ­Ù…ÙŠÙ„...</div>
    </div>
  </div>

  <div id="tickerTape" role="marquee" aria-live="off">
    <div class="ticker-content">
        <span class="ticker-item">   Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±ÙŠÙ† ÙÙ‚Ø· </span>
            <span class="ticker-item">   </span>

      <span class="ticker-item">  Ø§ØºÙ„Ø§Ù‚ Ø¨Ø§Ø¨ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ù„ÙˆØ¸ÙŠÙØ© : Ù…Ø³Ø¤ÙˆÙ„ Ø¯Ø¹Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ â€“ Ø§Ù„Ø®Ø±Ø·ÙˆÙ… </span>

      <span class="ticker-item">   </span>
   
                 <span class="ticker-item">  ØªØ£ÙƒØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø§Ù…Ù„  </span>
       
  
                 <span class="ticker-item">   </span>
                   
     <span class="ticker-item"> Ø§Ù„Ø¯Ù„Ø§Ù„Ø©Ø› Ù…Ù†ØµØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ØªÙ‡Ø¯Ù Ø¥Ù„Ù‰ ØªØ³Ù‡ÙŠÙ„ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª  </span>
 
        </div>
  </div>
  <main>
    <section id="home" class="active" aria-live="polite">
      <div id="grid" class="grid" role="list" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª"></div>
      <div id="noitems" style="display:none;text-align:center;margin-top:15px" class="small">Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ , ÙŠØ±Ø¬ÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø¹Ù„Ø§Ù†Ø§Øª</div>
    </section>

    <section id="send">
      <div class="panel">
        <h2>Ù„ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø¥Ø¹Ù„Ø§Ù† Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ£Ø±Ø³Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ ÙŠÙÙØ¶Ù‘Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ Google Chrome Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø©.</h2>
        <p class="small muted">Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¹Ù„Ø§Ù†Ùƒ ÙˆÙ†Ø´Ø±Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©.</p>

        <div style="display:grid;gap:8px">
          <input id="f_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" required>
          <input id="f_price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
          <textarea id="f_desc" placeholder="ÙˆØµÙ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" rows="4"></textarea>
          <input id="f_loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹">
          <input id="f_contact" placeholder="Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„">
          <input id="f_cat" placeholder="Ø§Ù„Ù‚Ø³Ù…">
          <div><input id="f_file" type="file" accept="image/*"></div>
          <label style="display:flex;gap:8px;align-items:center">
            <input type="checkbox" id="agree" required/>
            <span class="small">Ø£Ù‚Ø± Ø£Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø© ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø´Ø±</span>
          </label>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="submitBtn" class="btn" type="button">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
            <div id="submitStatus" class="small"></div>
          </div>
          </div>
      </div>
    </section>
    <section id="privacy">
      <div class="panel">
        <h3>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h3>
        <div style="white-space:pre-wrap;background:#fff;padding:12px;border-radius:8px;border:1px solid #eef6ff;margin-top:8px" class="small muted">
Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©Ø› Ù…Ù†ØµØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ØªÙ‡Ø¯Ù Ø¥Ù„Ù‰ ØªØ³Ù‡ÙŠÙ„ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙˆØ¨Ø© ÙˆØªÙ…ÙƒÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† Ø§Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ø³Ù‡ÙˆÙ„Ø© Ø¯Ø§Ø®Ù„ Ù…Ø¯Ù†Ù‡Ù….
          ÙŠÙˆÙØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ³ÙŠÙ„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¯ÙˆÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø·Ø±ÙÙ‹Ø§ ÙÙŠ Ø£ÙŠ ØªØ¹Ø§Ù…Ù„ ØªØ¬Ø§Ø±ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.

Ø¥Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ùˆ Ù„Ø£ÙŠ Ù…Ù† Ø®Ø¯Ù…Ø§ØªÙ‡ ÙŠØ´ÙƒÙ‘Ù„ Ù…ÙˆØ§ÙÙ‚Ø© ÙƒØ§Ù…Ù„Ø© ÙˆØµØ±ÙŠØ­Ø© Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ§Ù„ÙŠØ©  ÙˆÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø¹Ù„Ù‰ Ø£ÙŠ Ø¬Ø²Ø¡ Ù…Ù†Ù‡Ø§ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„ØªÙˆÙ‚Ù ÙÙˆØ±Ù‹Ø§ Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹.

1. Ù†Ø·Ø§Ù‚ Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ·Ø¨ÙŠØ¹ØªÙ‡Ø§

ÙŠÙˆÙÙ‘Ø± Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© Ù…Ù†ØµØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§ØªØŒ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØŒ ÙˆØ±ÙˆØ§Ø¨Ø· Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø£Ùˆ Ø®Ø¯Ù…Ø§Øª Ù…Ù‚Ø¯Ù‘Ù…Ø© Ù…Ù† Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø©  ÙˆÙ„Ø§ ÙŠÙ‚Ø¯Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£ÙŠ Ø¶Ù…Ø§Ù† â€” ØµØ±ÙŠØ­Ù‹Ø§ Ø£Ùˆ Ø¶Ù…Ù†ÙŠÙ‹Ø§ â€” ÙŠØªØ¹Ù„Ù‚ Ø¨Ù€:

Ø¯Ù‚Ø© ÙˆØµØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø© ÙÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª.

Ù…ØµØ¯Ø§Ù‚ÙŠØ© Ø§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ†.

Ø¬ÙˆØ¯Ø© Ø£Ùˆ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©.

ÙˆÙŠØ¯Ø±Ùƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ ÙƒÙˆØ³ÙŠØ· ØªÙ‚Ù†ÙŠ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙ‚Ø·ØŒ ÙˆÙ„Ø§ ÙŠØ¹Ø¯ Ø·Ø±ÙÙ‹Ø§ ÙÙŠ Ø£ÙŠ Ù…Ø¹Ø§Ù…Ù„Ø© ØªØ¬Ø§Ø±ÙŠØ© ØªØªÙ… Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø£Ùˆ Ø¨ÙŠÙ†Ù‡Ù… ÙˆØ¨ÙŠÙ† Ø§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ†.

2. Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª

ØªØªÙ… Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ† Ø£Ùˆ Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ø¹Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.
Ù„Ø§ ÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø£Ùˆ Ù…Ø§Ù„ÙŠØ© Ø£Ùˆ ØªØ¹ÙˆÙŠØ¶ÙŠØ© ØªØªØ¹Ù„Ù‚ Ø¨Ù…Ø§ ÙŠÙ„ÙŠ:

Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ¹Ø§Ù…Ù„Ø§ØªØŒ

Ø§Ù„Ø®Ø³Ø§Ø¦Ø± Ø£Ùˆ Ø§Ù„Ø£Ø¶Ø±Ø§Ø±ØŒ

Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ Ø£Ùˆ Ø§Ù„ØªØ¶Ù„ÙŠÙ„ØŒ

Ø³ÙˆØ¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ

Ø£ÙŠ Ù†Ø²Ø§Ø¹Ø§Øª Ø£Ùˆ Ù…Ø·Ø§Ù„Ø¨Ø§Øª ØªÙ†Ø´Ø£ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø£Ùˆ Ø§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ†.

3. Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

ÙŠØªØ¹Ù‡Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù…Ø§ ÙŠÙ„ÙŠ:

Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ø§Ø±ÙŠØ©.

Ø¹Ø¯Ù… Ù†Ø´Ø± Ø£ÙŠ Ù…Ø­ØªÙˆÙ‰ Ù…Ø³ÙŠØ¡ Ø£Ùˆ Ù…Ø®Ø§Ù„Ù Ø£Ùˆ Ù…Ø¶Ù„Ù„ Ø£Ùˆ Ù…Ù†ØªÙ‡Ùƒ Ù„Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø§Ù„ÙÙƒØ±ÙŠØ© Ø£Ùˆ Ø§Ù„Ø®ØµÙˆØµÙŠØ©.

Ø¹Ø¯Ù… Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø®ØªØ±Ø§Ù‚ Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø£ÙŠ ØµÙˆØ±Ø© ÙƒØ§Ù†Øª.

Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø£ÙŠ Ù†Ø´Ø§Ø· ØºÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø£Ùˆ Ø¶Ø§Ø± Ø¨Ø§Ù„Ù…Ù†ØµØ© Ø£Ùˆ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.

ÙˆÙŠØ­Ù‚ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø­Ø¸Ø± Ø£Ùˆ ØªØ¹Ù„ÙŠÙ‚ ÙˆØµÙˆÙ„ Ø£ÙŠ Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ®Ø§Ù„Ù Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ·ØŒ Ø¯ÙˆÙ† Ø¥Ø´Ø¹Ø§Ø± Ù…Ø³Ø¨Ù‚ ÙˆØ¯ÙˆÙ† Ø£ÙŠ Ø§Ù„ØªØ²Ø§Ù… Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨.

4. Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ

Ù‚Ø¯ ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ Ø£Ùˆ Ø®Ø¯Ù…Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©.
Ù„Ø§ ÙŠØªØ­Ù…Ù„ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© Ø£ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¹Ù†:

Ù…Ø­ØªÙˆÙ‰ ØªÙ„Ùƒ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ØŒ

Ø³ÙŠØ§Ø³Ø§ØªÙ‡Ø§ Ø£Ùˆ Ù…Ù…Ø§Ø±Ø³Ø§ØªÙ‡Ø§ØŒ

Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠÙ‡Ø§ØŒ

Ø£Ùˆ Ø£ÙŠ Ø¶Ø±Ø± Ù‚Ø¯ ÙŠÙ†Ø´Ø£ Ø¹Ù† Ø²ÙŠØ§Ø±ØªÙ‡Ø§ Ø£Ùˆ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§.

ÙˆÙŠØªÙˆÙ„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ­Ø¯Ù‡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ØªÙ„Ùƒ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§.

5. ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø­Ø°Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰

ÙŠØ­ØªÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„Ø­Ù‚ Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ:

ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø£ÙŠ Ø¥Ø¹Ù„Ø§Ù† Ø£Ùˆ Ù…Ø­ØªÙˆÙ‰ØŒ

Ø­Ø°Ù Ø£ÙŠ Ù…Ø§Ø¯Ø© ÙŠØ±Ø§Ù‡Ø§ Ù…Ø®Ø§Ù„ÙØ© Ø£Ùˆ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨Ø©ØŒ

Ø£Ùˆ Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ø®Ø¯Ù…Ø© Ø¨Ø´ÙƒÙ„ Ø¬Ø²Ø¦ÙŠ Ø£Ùˆ ÙƒÙ„ÙŠ.

ÙˆØ°Ù„Ùƒ Ø¯ÙˆÙ† Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¨Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø£Ùˆ ØªÙ‚Ø¯ÙŠÙ… Ø¥Ø´Ø¹Ø§Ø± Ù…Ø³Ø¨Ù‚.

6. Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø®ØµÙˆØµÙŠØ©

Ù‚Ø¯ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ù„ØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙˆØªØ´Ù…Ù„:

Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Cookies)ØŒ

ÙˆØ³Ø¬Ù„Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (Usage Logs).

7. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø±ÙˆØ·

ÙŠØ¬ÙˆØ² Ù„Ù„Ù…ÙˆÙ‚Ø¹ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ø­ÙŠÙ† Ù„Ø¢Ø®Ø±.
ØªØµØ¨Ø­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù†Ø§ÙØ°Ø© ÙÙˆØ± Ù†Ø´Ø±Ù‡Ø§ØŒ ÙˆÙŠÙØ¹Ø¯ Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù‚Ø¨ÙˆÙ„Ù‹Ø§ Ø¶Ù…Ù†ÙŠÙ‹Ø§ Ø¨Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„Ù…Ø­Ø¯Ø«Ø©.

8. Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ

ÙŠÙ‚Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø£Ù†Ù‡ Ù‚Ø¯ Ù‚Ø±Ø£ Ø¨Ù†ÙˆØ¯ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆÙÙ‡Ù…Ù‡Ø§ ÙˆÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯ÙˆÙ† Ù‚ÙŠØ¯ Ø£Ùˆ Ø´Ø±Ø·ØŒ ÙˆÙŠØªØ¹Ù‡Ø¯ Ø¨Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù‡Ø§ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ù„Ù…ÙˆÙ‚Ø¹.
 
info@eldelala.com
        </div>
      </div>
    </section>

    <section id="admin">
      <div class="panel">
        <h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±Ù</h2>
        <div id="admin-stats" class="grid-stats">
            <div class="stat-card"><strong>0</strong><span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</span></div>
            <div class="stat-card"><strong>0</strong><span>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</span></div>
            <div class="stat-card"><strong>0</strong><span>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</span></div>
            <div class="stat-card"><strong>-</strong><span>Ø£ÙƒØ«Ø± Ù‚Ø³Ù…</span></div>
            <div class="stat-card"><strong>-</strong><span>Ø¢Ø®Ø± ØªØ¹Ø¯ÙŠÙ„</span></div>
        </div>
        
        <h3 style="margin-top:30px;">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© (<span id="pending-count">0</span>)</h3>
        <div id="admin-pending-ads" class="admin-list-container">
            <div style="text-align:center; padding:20px;" class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.</div>
        </div>

        <h3 style="margin-top:30px;">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© (<span id="published-count">0</span>)</h3>
        <div id="admin-published-ads" class="admin-list-container">
            <div style="text-align:center; padding:20px;" class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø©.</div>
        </div>
      </div>
    </section>
    </main>

  <footer>
    <div>Ø§Ù„Ø¯Ù„Ø§Ù„Ø© â€” ØªØ£ÙƒØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø§Ù…Ù„.</div>
  </footer>
</div>

<div id="admin-login-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" style="z-index:1000">
  <div class="modalCard" role="document" aria-labelledby="loginTitle" style="max-width:400px; padding:20px; text-align:center;">
    <h3 id="loginTitle" style="margin-bottom:15px;">Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</h3>
    <input type="password" id="adminPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="margin-bottom:15px;">
    <button id="adminLoginBtn" class="btn" type="button">Ø¯Ø®ÙˆÙ„</button>
    <div id="loginStatus" class="small" style="margin-top:10px; color:red;"></div>
  </div>
</div>
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modalCard" role="document" aria-labelledby="modalTitle">
    <div style="padding:10px 12px;border-bottom:1px solid #e5e7eb">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <div>
          <div id="modalTitle" style="font-weight:800;font-size:18px"></div>
          <div id="modalMeta" class="small" style="margin-top:6px"></div>
        </div>
        <button id="modalClose" class="btn alt" type="button">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
    <div class="modalMain">
      <div class="modalImage">
        <img id="modalMainImg" src="" alt="" style="max-width:100%;max-height:100%;display:none" />
      </div>

      <div class="modalBody">
        <div id="modalDescription" class="fullDesc"></div>
        <div class="detailsList">
          <div class="detailsItem"><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹</strong><div id="modalLoc" class="muted"></div></div>
          <div class="detailsItem"><strong>Ø§Ù„ØªØµÙ†ÙŠÙ</strong><div id="modalCat" class="badge"></div></div>
          <div class="detailsItem"><strong>Ø§Ù„Ø³Ø¹Ø±</strong><div id="modalPrice" class="price"></div></div>
          <div class="detailsItem"><strong>Ø§Ù„ØªÙˆØ§ØµÙ„</strong><div id="modalContact" class="muted"></div></div>
        </div>
      </div>
    </div>

    <div class="modalFooter">
      <div class="modalActions">
        <a id="modalWhats" class="btn" target="_blank" rel="noopener">Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± WhatsApp</a>
        <a id="modalCall" class="btn alt" style="display:none" href="#">Ø§ØªØµØ§Ù„</a>
      </div>
      <div class="small muted">Ù…Ù„Ø§Ø­Ø¸Ø©: ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù†ÙØ³Ùƒ.</div>
    </div>
  </div>
</div>

<script defer>
/*** GitHub + cache buster ***/
const GITHUB_OWNER  = 'tocontactmsg-ai';
const GITHUB_REPO   = 'De';
const GITHUB_BRANCH = 'main';
const ADS_DIR       = 'ads';
const CACHE_BUSTER  = 'v1.0.1'; // ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«

/* Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø± */
const WHATSAPP_NUMBER = '249998615193'; // Ø¨Ø¯ÙˆÙ† Ø¹Ù„Ø§Ù…Ø© + Ø£Ùˆ Ù…Ø³Ø§ÙØ§Øª
// ğŸ’¡ NEW: Admin Password Constant
const ADMIN_PASSWORD = 'super-secret-admin-access';
// ğŸ’¡ NEW: Google Apps Script Web App URL for submission - REPLACE THIS WITH YOUR DEPLOYED URL
const APPS_SCRIPT_URL = 'YOUR_APPS_SCRIPT_WEB_APP_URL_HERE'; 


function escapeHtml(s){ return String(s||'').replace(/[&<>\"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]||c)); }
function debounce(fn,t=300){ let timer; return (...a)=>{ clearTimeout(timer); timer=setTimeout(()=>fn(...a),t); }; }
function genRef(){ return 'R' + Date.now().toString(36).slice(-6).toUpperCase(); } // Kept as a fallback/mock for now

/* ØªØ¨ÙˆÙŠØ¨Ø§Øª */
const listControls = document.getElementById('listControls');
document.querySelectorAll('.nav-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const target = btn.dataset.target;
    document.querySelectorAll('main > section').forEach(s=> s.classList.remove('active'));
    document.getElementById(target).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(n=>n.removeAttribute('aria-current'));
    btn.setAttribute('aria-current','true');
    listControls.style.display = (target === 'home') ? 'flex' : 'none';
    window.scrollTo({top:0,behavior:'smooth'});
    
    // ğŸ’¡ NEW: Ensure messages are cleared when switching sections
    if (target !== 'send') {
        const container = document.getElementById('msges-container');
        if (container) container.innerHTML = '';
        checkAndToggleVisibility();
    }
  });
});

/* Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
let ads = [];
const grid = document.getElementById('grid');
const qEl = document.getElementById('q');
const catFilter = document.getElementById('catFilter');
const countEl = document.getElementById('count');

function renderGrid(list){
  const noItems = document.getElementById('noitems');
  grid.innerHTML='';
  list = list || [];
  if(!list.length){
    noItems.style.display='block';
    countEl.textContent='0 Ø¥Ø¹Ù„Ø§Ù†';
    return;
  }
  noItems.style.display='none';
  list.forEach(a=>{
    const el = document.createElement('div');
    el.className='card';
    if(a.ref_code) el.id = 'ad-' + a.ref_code;
    const mediaHtml = a.image
      ? `<img src="${escapeHtml(a.image)}" alt="${escapeHtml(a.name||'')}" loading="lazy">`
      : '<div class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©</div>';
    el.innerHTML = `
      <div class="media">${mediaHtml}</div>
      <div class="body">
        <div class="title">${escapeHtml(a.name||'')}</div>
        <div class="desc">${escapeHtml(a.description||'')}</div>
        <div class="meta">
          <div class="badge">${escapeHtml(a.category||'Ø¹Ø§Ù…')}</div>
          <div class="price">${escapeHtml(a.price||'')}</div>
        </div>
        <div class="meta">
          <div class="small">${escapeHtml(a.location||'')}</div>
          <div class="small">${escapeHtml(a.ref_code||'')}</div>
        </div>
      </div>
    `;
    el.addEventListener('click', ()=>openDetails(a));
    grid.appendChild(el);
  });
  countEl.textContent = list.length + ' Ø¥Ø¹Ù„Ø§Ù†';
}

function applyFiltersAndRender(){
  const q = (qEl && qEl.value || '').trim().toLowerCase();
  const cat = (catFilter && catFilter.value || '').trim();
  let out = ads.slice();

  if(cat){
    out = out.filter(a => (a.category||'').toString() === cat);
  }
  if(q){
    out = out.filter(a => {
      const hay = ((a.name || '') + ' ' + (a.description||'') + ' ' + (a.location||'') + ' ' + (a.ref_code||'')).toLowerCase();
      return hay.indexOf(q) !== -1;
    });
  }
  
  // ----------------------------------------------------
  // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ø§Ù„ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª (Ø±Ù…Ø² Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†) ØªÙ†Ø§Ø²Ù„ÙŠØ§Ù‹ (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
  out.sort((A,B) => {
    // 1. Ø§Ù„ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ ref_code ØªÙ†Ø§Ø²Ù„ÙŠØ§Ù‹ (B Ù‚Ø¨Ù„ A ÙŠØ¹Ù†ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
    const timeSort = (B.ref_code || '').localeCompare((A.ref_code || ''));
    if(timeSort !== 0) return timeSort;
    
    // 2. Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ: Ø§Ù„Ø§Ø³Ù… (Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹)
    return (A.name || '').toString().localeCompare((B.name || '').toString(), 'ar');
  });
  // ----------------------------------------------------
  
  renderGrid(out);
}

/* ÙØªØ­ Ø¥Ø¹Ù„Ø§Ù† Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· (#ad-REF) */
function openAdFromHash(){
  try{
    const hash = window.location.hash;
    if(!hash || !hash.startsWith('#ad-')) return;
    const ref = decodeURIComponent(hash.slice(4)).trim();
    if(!ref) return;
    const item = ads.find(a => (a.ref_code || '') === ref);
    if(!item) return;

    // ØªÙØ¹ÙŠÙ„ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙ„Ø§ØªØ±
    document.querySelectorAll('main > section').forEach(s => s.classList.remove('active'));
    const home = document.getElementById('home');
    if(home) home.classList.add('active');
    if(listControls) listControls.style.display = 'flex';
    document.querySelectorAll('.nav-btn').forEach(btn=>{
      if(btn.dataset.target === 'home') btn.setAttribute('aria-current','true');
      else btn.removeAttribute('aria-current');
    });

    openDetails(item);
  }catch(e){
    console.warn('openAdFromHash error', e);
  }
}

/* Modal */
const modal = document.getElementById('modal');
const modalMainImg = document.getElementById('modalMainImg');
const modalTitle = document.getElementById('modalTitle');
const modalMeta = document.getElementById('modalMeta');
const modalDescription = document.getElementById('modalDescription');
const modalLoc = document.getElementById('modalLoc');
const modalCat = document.getElementById('modalCat');
const modalPrice = document.getElementById('modalPrice');
const modalContact = document.getElementById('modalContact');
const modalWhats = document.getElementById('modalWhats');
const modalCall = document.getElementById('modalCall');
const modalClose = document.getElementById('modalClose');

// ğŸ’¡ NEW: Store original modal content for restoration after admin edit
const originalModalBody = document.querySelector('#modal .modalBody');
const originalModalActions = document.querySelector('#modal .modalActions');
const originalModalBodyHTML = originalModalBody.innerHTML;
const originalModalActionsHTML = originalModalActions.innerHTML;


function closeModal(){
  modal.setAttribute('aria-hidden','true');
  modal.classList.remove('open');
  // ğŸ’¡ NEW: Restore original content when closing
  originalModalBody.innerHTML = originalModalBodyHTML;
  originalModalActions.innerHTML = originalModalActionsHTML;
}
modalClose.addEventListener('click', closeModal);
modal.addEventListener('click', e=>{ if(e.target===modal) closeModal(); });
document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeModal(); });

// ğŸ’¡ MODIFIED: openDetails now accepts an optional isEditing flag
async function openDetails(item, isEditing = false){
  // If editing, the calling function (openEditAdModal) will handle content population
  if (isEditing) return;

  modalTitle.textContent = item.name || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†';
  modalMeta.textContent = `Ø±Ù…Ø²: ${item.ref_code||''}`;
  modalDescription.textContent = item.description||'-';
  modalLoc.textContent = item.location||'-';
  modalCat.textContent = item.category||'Ø¹Ø§Ù…';
  modalPrice.textContent = item.price || '-';
  modalContact.textContent = item.contact || '-';

  if(item.image){
    modalMainImg.src = item.image;
    modalMainImg.style.display = 'block';
  } else {
    modalMainImg.src = '';
    modalMainImg.style.display = 'none';
  }

  if(item.contact && item.contact.trim()){
    modalCall.style.display = 'inline-block';
    const phoneDigits = (item.contact.match(/[+0-9][0-9() \-]{4,}/) || [])[0] || item.contact;
    modalCall.href = 'tel:' + phoneDigits.replace(/\s+/g,'').replace(/[^+0-9]/g,'');
  } else {
    modalCall.style.display = 'none';
  }

  const base = window.location.href.split('#')[0];
  const deepLink = base + '#ad-' + (item.ref_code||'');
  const msg = (item.name||'') + '\n' + (item.price||'') + '\n' + deepLink;
  modalWhats.href = 'https://wa.me/?text=' + encodeURIComponent(msg);
  modalWhats.target = '_blank';

  //  ÙˆØ­
  try{
    if(item.ref_code){
      const newHash = '#ad-' + encodeURIComponent(item.ref_code);
      if(window.location.hash !== newHash){
        history.replaceState(null, '', base + newHash);
      }
    }
  }catch(e){}

  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
}

/* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù† GitHub */
async function loadAdsFromGithub(){
  const noItemsEl = document.getElementById('noitems');
  const loadMoreBtn = document.getElementById('loadMoreBtn'); // kept as fallback/status
  const CACHE_KEY = 'eldelala_ads_cache_v2'; // ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ù„Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù„Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  const CACHE_TTL_MS = 60 * 60 * 1000; // ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«: 60 Ø¯Ù‚ÙŠÙ‚Ø© ÙƒØ§Ø´
  const MAX_ADS = 1000; // absolute cap
  const PAGE_SIZE = 70; // ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«: ØªØ­Ù…ÙŠÙ„ 50 Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  const CONCURRENCY = 8; // ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø©
  const FETCH_TIMEOUT_MS = 9000;
  const RETRIES = 2;

  let allFiles = [];
  let pageIndex = 0;
  let loadingPage = false;
  let scrollHandlerAttached = false;

  function timeoutFetch(url, opts = {}, ms = FETCH_TIMEOUT_MS){
    const controller = new AbortController();
    const id = setTimeout(()=>controller.abort(), ms);
    const o = Object.assign({}, opts, { signal: controller.signal });
    return fetch(url, o).finally(()=>clearTimeout(id));
  }
  function sleep(ms){ return new Promise(res=>setTimeout(res, ms)); }

  // Try cache
  try{
    const raw = localStorage.getItem(CACHE_KEY);
    if(raw){
      const parsed = JSON.parse(raw);
      if(parsed && Date.now() - (parsed.ts||0) < CACHE_TTL_MS && Array.isArray(parsed.ads)){
        ads = parsed.ads;
        try{
          const cats = [...new Set(ads.map(a=>a.category||'Ø¹Ø§Ù…'))];
          cats.sort((a,b)=> a.toString().localeCompare(b.toString(), 'ar'));
          if(catFilter){
            catFilter.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…</option>' +
              cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join('');
          }
        }catch(e){}
        applyFiltersAndRender();
        if(countEl) countEl.textContent = ads.length + ' Ø¥Ø¹Ù„Ø§Ù†  ';
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„ÙƒØ§Ø´ØŒ Ù„Ø§ Ù†Ù†ØªØ¸Ø±ØŒ Ø¨Ù„ Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ GitHub ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ù… Ù†ÙƒÙ† Ù‚Ø¯ Ø­Ù…Ù„Ù†Ø§ ÙƒÙ„ Ø´ÙŠØ¡
        if(ads.length < allFiles.length){
             // Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙƒØ§Ø´ Ø¬Ø§Ù‡Ø²Ø§Ù‹
        } else {
             // ÙƒÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„ÙƒØ§Ø´ØŒ Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ
             return; // Ù…Ù‡Ù…: Ø§Ù„Ø®Ø±ÙˆØ¬ Ù‡Ù†Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„ÙƒØ§Ø´
        }
      }
    }
  }catch(e){ console.warn('cache read failed', e); }

  try{
    const contentsUrl = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${ADS_DIR}?ref=${GITHUB_BRANCH}`;
    
    // ğŸ›‘ ØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ù‚Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ğŸ›‘
    const res = await timeoutFetch(contentsUrl, {
        headers: {
            'Accept': 'application/vnd.github.v3+json'
        }
    }, 7000); 

    if(!res.ok){
      console.warn('GitHub API status', res.status);
      if(noItemsEl){
        noItemsEl.style.display = 'block';
        noItemsEl.innerHTML = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (GitHub API). <br>status: ' + res.status;
      }
      if(countEl) countEl.textContent = '0 Ø¥Ø¹Ù„Ø§Ù†';
      return;
    }
    const files = await res.json();
    const jsonFiles = files.filter(f => f.type === 'file' && f.name.toLowerCase().endsWith('.json'));
    allFiles = jsonFiles.slice(0, Math.min(jsonFiles.length, MAX_ADS));

    // reset paging
    pageIndex = 0;
    
    applyFiltersAndRender();

    async function fetchPage(pageIdx){
      const start = pageIdx * PAGE_SIZE;
      const chunk = allFiles.slice(start, start + PAGE_SIZE);
      if(!chunk.length) return [];
      async function fetchWithRetries(url, tries = RETRIES){
        let attempt = 0;
        while(attempt <= tries){
          try{
            // Ù„Ø§ )
            const r = await timeoutFetch(url, {}, FETCH_TIMEOUT_MS); 
            if(!r.ok) throw new Error('status ' + r.status);
            const data = await r.json();
            return data;
          }catch(err){
            attempt++;
            if(attempt > tries) {
              console.warn('fetch failed', url, err);
              return null;
            }
            await sleep(200 * attempt);
          }
        }
        return null;
      }

      const results = [];
      for(let i=0;i<chunk.length;i+=CONCURRENCY){
        const sub = chunk.slice(i, i+CONCURRENCY);
        const promises = sub.map(async (f)=>{
          try{
            const rawUrl = `https://raw.githubusercontent.com/${GITHUB_OWNER}/${GITHUB_REPO}/${GITHUB_BRANCH}/${ADS_DIR}/${encodeURIComponent(f.name)}`;
            const data = await fetchWithRetries(rawUrl);
            if(!data) return null;
            return {
              ref_code: data.ref_code || data.ref || f.name.replace(/\.json$/i,''),
              name: data.name || data.title || '',
              price: data.price || data.amount || '',
              description: data.description || data.desc || data.body || '',
              location: data.location || data.city || data.loc || '',
              contact: data.contact || data.phone || data.tel || '',
              category: (data.category || data.cat || data.type || data.Category || '').toString().trim() || 'Ø¹Ø§Ù…',
              image: data.image || data.thumb || data.imageDataUrl || ''
            };
          }catch(e){
            console.warn('error loading ad', f.name, e);
            return null;
          }
        });
        const loaded = await Promise.all(promises);
        results.push(...loaded.filter(Boolean));
        await sleep(80);
      }
      return results;
    }

    async function loadNext(){
      if(loadingPage) return;
      loadingPage = true;
      // show small inline indicator (using loadMoreBtn as status element)
      const isInitialLoad = ads.length === 0;
      if(loadMoreBtn){
        loadMoreBtn.style.display = 'inline-block';
        loadMoreBtn.disabled = true;
        loadMoreBtn.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
      }
      
      const pageData = await fetchPage(pageIndex);
      
      if(pageData && pageData.length){
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ (Ø¨Ø¯ÙˆÙ† ÙƒØ§Ø´)
        if (isInitialLoad && pageIndex === 0) {
            ads = pageData;
        } else {
            // ÙˆØ¥Ù„Ø§ØŒ Ù†Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            ads = ads.concat(pageData.filter(newAd => 
              !ads.some(existingAd => existingAd.ref_code === newAd.ref_code)
            ));
        }
        
        try{
          const cats = [...new Set(ads.map(a=>a.category||'Ø¹Ø§Ù…'))];
          cats.sort((a,b)=> a.toString().localeCompare(b.toString(), 'ar'));
          if(catFilter){
            catFilter.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…</option>' +
              cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`).join('');
          }
        }catch(e){}
        applyFiltersAndRender();
        try{ localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: Date.now(), ads })); }catch(e){}
      }
      pageIndex++;
      loadingPage = false;

      const remaining = Math.max(0, allFiles.length - ads.length);
      if(remaining <= 0){
        // remove scroll listener if no more
        detachScrollHandler();
        if(loadMoreBtn) loadMoreBtn.style.display = 'none';
      } else {
        if(loadMoreBtn){
          loadMoreBtn.style.display = 'inline-block';
          loadMoreBtn.disabled = false;
          loadMoreBtn.textContent = 'Ø§Ù„Ù…Ø²ÙŠØ¯ (' + remaining + ')';
        }
      }
      if(countEl) countEl.textContent = ads.length + ' Ø¥Ø¹Ù„Ø§Ù†';
      
      // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ø³ ub)
    }

    // infinite scroll: load when user is near page bottom
    function shouldLoadMore(){
      const scrollY = window.scrollY || window.pageYOffset;
      const viewportH = window.innerHeight || document.documentElement.clientHeight;
      const fullH = document.documentElement.scrollHeight;
      // when within 1200px of bottom OR scrolled past 70% of content
      if(fullH - (scrollY + viewportH) < 1200) return true;
      if((scrollY + viewportH) / fullH > 0.7) return true;
      return false;
    }

    async function onScroll(){
      if(loadingPage) return;
      if(shouldLoadMore()){
        await loadNext();
      }
    }

    function attachScrollHandler(){
      if(scrollHandlerAttached) return;
      window.addEventListener('scroll', onScroll, { passive: true });
      window.addEventListener('resize', onScroll);
      scrollHandlerAttached = true;
    }
    function detachScrollHandler(){
      if(!scrollHandlerAttached) return;
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('resize', onScroll);
      scrollHandlerAttached = false;
    }

    // auto-load first page, then attach scroll handler
    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ÙƒØ§Ø´ØŒ ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ ØµÙØ­Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„
    if (ads.length === 0 || ads.length < PAGE_SIZE) {
        await loadNext();
    }
    
    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù„ØªØ­Ù…ÙŠÙ„Ù‡ØŒ Ù‚Ù… Ø¨Ø±Ø¨Ø· Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ±
    if (allFiles.length > ads.length) {
        attachScrollHandler();
    } 
    // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ openAdFromHash() Ù…Ù† Ù‡Ù†Ø§ (Ù„Ø£Ù†Ù‡Ø§ Ø³ØªØ³ØªØ¯Ø¹Ù‰ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ loadAdsFromGithub)


    if(allFiles.length > 0 && noItemsEl){
      noItemsEl.style.display = 'none';
    }

  }catch(err){
    console.error('loadAdsFromGithub failed', err);
    if(noItemsEl){
      noItemsEl.style.display='block';
      noItemsEl.textContent = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (Ø®Ø·Ø£ Ø§ØªØµØ§Ù„ Ø£Ùˆ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª  ).';
    }
    if(countEl) countEl.textContent='0 Ø¥Ø¹Ù„Ø§Ù†';
  }
}




/* = = */

/* ========================================================== */
/* ğŸ’¡ NEW: MESSAGE SYSTEM FUNCTIONS */
/* ========================================================== */
const msgContainer = document.getElementById('msges-container');

/**
 * Checks the container's content and toggles its visibility.
 * Requirement: "if no msgs make it disappear"
 */
function checkAndToggleVisibility() {
    if (!msgContainer) return;
    if (msgContainer.children.length === 0) {
        msgContainer.style.display = 'none'; 
    } else {
        msgContainer.style.display = 'block'; 
    }
}

/**
 * Creates and displays a new message (MSEGS).
 * @param {string} type - 'success' or 'error'
 * @param {string} text - The Arabic message content
 */
function displayMessage(type, text) {
    if (!msgContainer) return;
    try {
        // Clear existing messages for a fresh alert
        msgContainer.innerHTML = '';

        // Create elements
        const newMsg = document.createElement('div');
        newMsg.className = 'msges-box ' + type;
        
        const textSpan = document.createElement('span');
        textSpan.textContent = text;
        newMsg.appendChild(textSpan);

        const closeBtn = document.createElement('button');
        closeBtn.className = 'close-btn';
        closeBtn.innerHTML = '&times;'; // 'x' symbol
        
        // Close button logic
        closeBtn.addEventListener('click', function() {
            newMsg.remove();
            checkAndToggleVisibility(); // Re-check visibility after removal
        });
        
        newMsg.appendChild(closeBtn);
        
        // Append the message and show the container
        msgContainer.appendChild(newMsg);
        checkAndToggleVisibility();

        // Auto-hide after 7 seconds for success messages
        if (type === 'success') {
            setTimeout(() => {
                if (newMsg.parentNode) {
                    newMsg.remove();
                    checkAndToggleVisibility();
                }
            }, 7000); 
        }
        
    } catch (error) {
        console.error("Critical error displaying message:", error);
    }
}
/* ğŸ›‘ END NEW MESSAGE SYSTEM FUNCTIONS */
/* ========================================================== */


/* ========================================================== */
/* ğŸ’¡ NEW: ADMIN ACCESS AND MANAGEMENT LOGIC */
/* ========================================================== */

const adminLoginModal = document.getElementById('admin-login-modal');
const adminPasswordEl = document.getElementById('adminPassword');
const adminLoginBtn = document.getElementById('adminLoginBtn');
const loginStatusEl = document.getElementById('loginStatus');
const adminNavBtn = document.getElementById('adminNavBtn');
const headerTitle = document.querySelector('header .brand .title');
let logoClickCount = 0;
let isAdminLoggedIn = false;

// Mock pending ads array (for demonstration purposes, as there is no backend)
let mockPendingAds = [];

// --- Admin Panel Functions ---

function openAdminLoginModal() {
    if (isAdminLoggedIn) {
        document.getElementById('adminNavBtn').click();
        return;
    }
    adminPasswordEl.value = '';
    loginStatusEl.textContent = '';
    adminLoginModal.setAttribute('aria-hidden', 'false');
    document.addEventListener('keydown', handleAdminLoginKeydown);
}

function closeAdminLoginModal() {
    adminLoginModal.setAttribute('aria-hidden', 'true');
    document.removeEventListener('keydown', handleAdminLoginKeydown);
}

function handleAdminLoginKeydown(e) {
    if (e.key === 'Escape') {
        closeAdminLoginModal();
    } else if (e.key === 'Enter') {
        attemptAdminLogin();
    }
}

function attemptAdminLogin() {
    const password = adminPasswordEl.value.trim();
    if (password === ADMIN_PASSWORD) {
        isAdminLoggedIn = true;
        closeAdminLoginModal();
        adminNavBtn.style.display = 'inline-block';
        adminNavBtn.click(); // Switch to the admin panel
        displayMessage('success', 'âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù.');
        headerTitle.removeEventListener('click', handleLogoClick);

    } else {
        loginStatusEl.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.';
        adminPasswordEl.value = '';
        displayMessage('error', 'ğŸš« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
    }
}

// Attach the click handler to the logo
function handleLogoClick() {
    if (isAdminLoggedIn) return;

    logoClickCount++;
    if (logoClickCount >= 7) {
        logoClickCount = 0;
        openAdminLoginModal();
    }
}
headerTitle.addEventListener('click', handleLogoClick);
adminLoginBtn.addEventListener('click', attemptAdminLogin);


// --- Ad Management Logic ---

/**
 * Mocks the deletion of an ad by removing it from the local arrays.
 */
window.handleDeleteAd = function(refCode, isPending) { // Expose to window for inline onclick
    if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ${refCode}ØŸ\n(Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø³ÙŠØ­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø· ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶)`)) {
        return;
    }

    if (isPending) {
        mockPendingAds = mockPendingAds.filter(a => a.ref_code !== refCode);
        displayMessage('success', `ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø¹Ù„Ù‚ ${refCode} Ù…Ø­Ù„ÙŠØ§Ù‹.`);
    } else {
        ads = ads.filter(a => a.ref_code !== refCode);
        displayMessage('success', `ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ù†Ø´ÙˆØ± ${refCode} Ù…Ø­Ù„ÙŠØ§Ù‹.`);
    }
    
    // NOTE: In a real application, you would make an API call here to delete the file on GitHub.
    
    applyFiltersAndRender();
    renderAdminPanel();
}


/**
 * Mocks the approval of a pending ad by moving it to the main 'ads' array.
 */
window.handleApproveAd = function(refCode) { // Expose to window for inline onclick
    if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ${refCode}ØŸ\n(Ø³ÙŠØªÙ… Ù†Ø´Ø±Ù‡ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù…Ø­Ù„ÙŠØ§Ù‹)`)) {
        return;
    }
    
    const adToApprove = mockPendingAds.find(a => a.ref_code === refCode);
    if (!adToApprove) return;

    mockPendingAds = mockPendingAds.filter(a => a.ref_code !== refCode);
    
    const publishedAd = Object.assign({}, adToApprove);
    delete publishedAd.image; // Assume published ads do not contain embedded image data
    
    ads.push(publishedAd);

    // NOTE: In a real application, this would involve creating the JSON file on GitHub.

    displayMessage('success', `âœ… ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ${refCode} Ø¨Ù†Ø¬Ø§Ø­.`);

    applyFiltersAndRender();
    renderAdminPanel();
}


/**
 * Populates the Edit Ad Modal with data and opens it.
 */
window.openEditAdModal = function(ad, isPending) { // Expose to window for inline onclick
    // 1. Setup the modal for editing by calling openDetails with the flag
    openDetails(ad, true); 
    
    // 2. Clear standard view elements and replace with an edit form structure
    originalModalBody.innerHTML = `
        <div id="edit-ad-form">
            <input type="text" id="edit_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" value="${escapeHtml(ad.name||'')}" />
            <input type="text" id="edit_price" placeholder="Ø§Ù„Ø³Ø¹Ø±" value="${escapeHtml(ad.price||'')}" />
            <textarea id="edit_desc" placeholder="ÙˆØµÙ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" rows="4">${escapeHtml(ad.description||'')}</textarea>
            <input type="text" id="edit_loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹" value="${escapeHtml(ad.location||'')}" />
            <input type="text" id="edit_contact" placeholder="Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„" value="${escapeHtml(ad.contact||'')}" />
            <input type="text" id="edit_cat" placeholder="Ø§Ù„Ù‚Ø³Ù…" value="${escapeHtml(ad.category||'')}" />
            <div class="small muted" style="margin-top:10px;">Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©ØŒ ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.</div>
        </div>
    `;

    // 3. Modify modal actions to include save/cancel buttons
    originalModalActions.innerHTML = `
        <button id="saveEditBtn" class="btn" type="button" style="background: #0078d7;">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
        <button id="cancelEditBtn" class="btn" type="button" style="background: #dc2626;">Ø¥Ù„ØºØ§Ø¡</button>
    `;
    
    document.getElementById('saveEditBtn').addEventListener('click', () => {
        const newAdData = {
            ref_code: ad.ref_code,
            name: document.getElementById('edit_name').value.trim(),
            price: document.getElementById('edit_price').value.trim(),
            description: document.getElementById('edit_desc').value.trim(),
            location: document.getElementById('edit_loc').value.trim(),
            contact: document.getElementById('edit_contact').value.trim(),
            category: document.getElementById('edit_cat').value.trim(),
            image: ad.image // keep original image reference
        };
        
        // Update local arrays
        if (isPending) {
            const index = mockPendingAds.findIndex(a => a.ref_code === ad.ref_code);
            if (index !== -1) mockPendingAds[index] = newAdData;
        } else {
            const index = ads.findIndex(a => a.ref_code === ad.ref_code);
            if (index !== -1) ads[index] = newAdData;
        }

        // NOTE: In a real application, you would make an API call here to update the JSON file on GitHub.

        displayMessage('success', `âœï¸ ØªÙ… Ø­ÙØ¸ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ${ad.ref_code} Ù…Ø­Ù„ÙŠØ§Ù‹.`);
        closeModal();
        applyFiltersAndRender();
        renderAdminPanel();
    });
    
    document.getElementById('cancelEditBtn').addEventListener('click', closeModal);
}


/**
 * Renders the Admin Panel with stats and ad lists.
 */
function renderAdminPanel() {
    const adminStats = document.getElementById('admin-stats');
    const adminPendingAds = document.getElementById('admin-pending-ads');
    const adminPublishedAds = document.getElementById('admin-published-ads');
    const pendingCount = document.getElementById('pending-count');
    const publishedCount = document.getElementById('published-count');
    
    // --- 1. Populate Stats ---
    const totalAds = ads.length + mockPendingAds.length;
    const published = ads.length;
    const pending = mockPendingAds.length;
    
    // Get last load time (using ref_code as timestamp mock)
    const latestAd = ads.length > 0 ? ads.reduce((latest, ad) => 
        (ad.ref_code || '').localeCompare(latest.ref_code || '') > 0 ? ad : latest, ads[0]
    ) : null;
    const lastLoadTime = latestAd ? new Date(parseInt(latestAd.ref_code.slice(1), 36)).toLocaleString('ar-EG') : '-';
    
    // Top Category (Simple logic)
    const allCategories = ads.map(a => a.category || 'Ø¹Ø§Ù…').concat(mockPendingAds.map(a => a.category || 'Ø¹Ø§Ù…'));
    const categoryCounts = allCategories.reduce((acc, cat) => { acc[cat] = (acc[cat] || 0) + 1; return acc; }, {});
    let topCategory = '-';
    let maxCount = 0;
    for (const cat in categoryCounts) {
        if (categoryCounts[cat] > maxCount) {
            maxCount = categoryCounts[cat];
            topCategory = cat;
        }
    }


    adminStats.innerHTML = `
        <div class="stat-card"><strong>${totalAds}</strong><span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</span></div>
        <div class="stat-card"><strong>${published}</strong><span>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</span></div>
        <div class="stat-card"><strong>${pending}</strong><span>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</span></div>
        <div class="stat-card"><strong>${topCategory}</strong><span>Ø£ÙƒØ«Ø± Ù‚Ø³Ù…</span></div>
        <div class="stat-card"><strong>${lastLoadTime}</strong><span>Ø¢Ø®Ø± ØªØ¹Ø¯ÙŠÙ„</span></div>
    `;

    // --- 2. Render Ad Tables ---
    
    // Helper to render a table row
    function renderAdRow(ad, isPending) {
        const adName = escapeHtml(ad.name || '');
        const refCode = escapeHtml(ad.ref_code || '');
        const category = escapeHtml(ad.category || 'Ø¹Ø§Ù…');
        const location = escapeHtml(ad.location || '-');
        
        // NOTE: The inline JSON.stringify is necessary for passing objects to the global function call
        const adJsonString = JSON.stringify(ad).replace(/'/g, '&#39;').replace(/"/g, '&quot;'); 

        const editBtn = `<button class="btn edit-btn" type="button" onclick="openEditAdModal(${adJsonString}, ${isPending})">ØªØ¹Ø¯ÙŠÙ„</button>`;

        const deleteBtn = `<button class="btn delete-btn" type="button" onclick="handleDeleteAd('${refCode}', ${isPending})">Ø­Ø°Ù</button>`;
        
        let actions = `${editBtn} ${deleteBtn}`;
        if (isPending) {
            const approveBtn = `<button class="btn approve-btn" type="button" onclick="handleApproveAd('${refCode}')">Ù†Ø´Ø±</button>`;
            actions = `${approveBtn} ${editBtn} ${deleteBtn}`;
        }

        return `
            <tr>
                <td>${refCode}</td>
                <td>${adName}</td>
                <td>${category}</td>
                <td>${location}</td>
                <td style="width:1%;">
                    <div class="action-btns">${actions}</div>
                </td>
            </tr>
        `;
    }
    
    // Pending Ads Table
    pendingCount.textContent = mockPendingAds.length;
    let pendingTableHtml = '<div style="text-align:center; padding:20px;" class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.</div>';
    if (mockPendingAds.length > 0) {
        // Sort by ref_code (newest first)
        const sortedPending = mockPendingAds.slice().sort((A,B) => (B.ref_code || '').localeCompare((A.ref_code || ''));
        pendingTableHtml = `
            <table class="admin-table">
                <thead>
                    <tr>
                        <th style="width:10%;">Ø±Ù…Ø²</th>
                        <th style="width:40%;">Ø§Ù„Ø§Ø³Ù…</th>
                        <th style="width:20%;">Ø§Ù„Ù‚Ø³Ù…</th>
                        <th style="width:20%;">Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                        <th style="width:10%; text-align: left;">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody>
                    ${sortedPending.map(ad => renderAdRow(ad, true)).join('')}
                </tbody>
            </table>
        `;
    }
    adminPendingAds.innerHTML = pendingTableHtml;


    // Published Ads Table
    publishedCount.textContent = ads.length;
    let publishedTableHtml = '<div style="text-align:center; padding:20px;" class="small muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø©.</div>';
    if (ads.length > 0) {
        // Sort by ref_code (newest first)
        const sortedAds = ads.slice().sort((A,B) => (B.ref_code || '').localeCompare((A.ref_code || '')));
        publishedTableHtml = `
            <table class="admin-table">
                <thead>
                    <tr>
                        <th style="width:10%;">Ø±Ù…Ø²</th>
                        <th style="width:40%;">Ø§Ù„Ø§Ø³Ù…</th>
                        <th style="width:20%;">Ø§Ù„Ù‚Ø³Ù…</th>
                        <th style="width:20%;">Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                        <th style="width:10%; text-align: left;">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody>
                    ${sortedAds.map(ad => renderAdRow(ad, false)).join('')}
                </tbody>
            </table>
        `;
    }
    adminPublishedAds.innerHTML = publishedTableHtml;
}


// Override loadAdsFromGithub to create mock pending ads after loading
const originalLoadAdsFromGithub = loadAdsFromGithub;
loadAdsFromGithub = async function() {
    await originalLoadAdsFromGithub();
    
    // Create mock pending ads from the first few loaded ads for demonstration
    if (mockPendingAds.length === 0 && ads.length > 0) {
        // Take the first 3 ads and move them to pending (and remove from published for a clean demo)
        const numToMock = Math.min(3, ads.length);
        mockPendingAds = ads.splice(0, numToMock).map(ad => Object.assign({}, ad, { is_pending: true }));
        applyFiltersAndRender(); // Re-render the main grid after splicing
    }
    
    // Now call renderAdminPanel if we are in the admin section
    if (document.getElementById('admin').classList.contains('active')) {
        renderAdminPanel();
    }
};

// Ensure renderAdminPanel is called when switching to admin view
document.getElementById('adminNavBtn').addEventListener('click', renderAdminPanel);

/* ğŸ›‘ END NEW ADMIN ACCESS AND MANAGEMENT LOGIC */
/* ========================================================== */


/* ========================================================== */
/* ğŸ’¡ NEW: AD SUBMISSION LOGIC USING GOOGLE APPS SCRIPT */
/* ========================================================== */

function fileToDataUrl(file){
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = ()=>resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

(function(){
  const submitBtn = document.getElementById('submitBtn');
  const submitStatus = document.getElementById('submitStatus');
  const f_name = document.getElementById('f_name');
  const f_price = document.getElementById('f_price');
  const f_desc = document.getElementById('f_desc');
  const f_loc = document.getElementById('f_loc');
  const f_contact = document.getElementById('f_contact');
  const f_cat = document.getElementById('f_cat');
  const f_file = document.getElementById('f_file');
  const agree = document.getElementById('agree');

  function showStatus(msg, isError=false){
    submitStatus.textContent = msg;
    submitStatus.style.color = isError ? '#b45309' : '#0b84ff';
  }

  submitBtn && submitBtn.addEventListener('click', async ()=>{
    try{
      msgContainer.innerHTML = '';
      checkAndToggleVisibility();
      
      if(submitBtn.disabled) return;
      
      const name = f_name.value.trim();
      if(!name || name.length < 2){
        displayMessage('error', 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ÙˆØ§Ø¶Ø­ ÙˆÙ…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.');
        return;
      }
      if(!agree.checked){
        displayMessage('error', 'ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø´Ø± Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.');
        return;
      }
      
      submitBtn.disabled = true;
      submitBtn.textContent = '...Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
      showStatus('Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±...');
      
      let imageBase64 = null;
      let mimeType = null;
      if(f_file.files && f_file.files[0]){
        showStatus('Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©...');
        const file = f_file.files[0];
        const dataUrl = await fileToDataUrl(file);
        // Extract Base64 part and MIME type
        const parts = dataUrl.split(';');
        mimeType = parts[0].split(':')[1];
        imageBase64 = parts[1].split(',')[1];
      }
      
      const payload = {
        name: name,
        price: f_price.value.trim(),
        description: f_desc.value.trim(),
        location: f_loc.value.trim(),
        contact: f_contact.value.trim(),
        category: f_cat.value.trim(),
        image: imageBase64,
        mime: mimeType
      };
      
      if (APPS_SCRIPT_URL.includes('YOUR_APPS_SCRIPT_WEB_APP_URL_HERE')) {
         throw new Error("âŒ Ù„Ù… ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ø±Ø§Ø¨Ø· Google Apps Script. Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹ÙŠÙŠÙ† APPS_SCRIPT_URL.");
      }

      const response = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' }, // Crucial for Apps Script doPost
        body: JSON.stringify(payload)
      });
      
      const result = await response.json();
      
      if(response.ok && result.status === 'success'){
        displayMessage('success', `âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø±Ù…Ø² Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©: ${result.ref_code}. Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù‚Ø±ÙŠØ¨Ø§Ù‹.`);
        showStatus('ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­. Ø±Ù…Ø² Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: ' + result.ref_code, false);
        // Clear form
        f_name.value = f_price.value = f_desc.value = f_loc.value = f_contact.value = f_cat.value = '';
        f_file.value = null;
        agree.checked = false;
      } else {
        throw new Error(result.error || 'ÙØ´Ù„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Apps Script.');
      }

    }catch(err){
      console.error(err);
      const errorMsg = err.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø§Ø¨Ø· Apps Script.';
      displayMessage('error', 'ğŸš« ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ' + errorMsg);
      showStatus('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø§Ù†Ø¸Ø± ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.', true);
    }finally{
      submitBtn.disabled = false;
      submitBtn.textContent = 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©';
    }
  });
})();
/* ğŸ›‘ END NEW AD SUBMISSION LOGIC */


/* ===== Øª = */

//  Ø§Ù„Ø£Ø¯Ø§Ø¡
if(qEl){
  qEl.addEventListener('input', debounce(applyFiltersAndRender, 300));
}

//  Ø±
if(catFilter){
  catFilter.addEventListener('change', applyFiltersAndRender);
}

//  
const refreshBtn = document.getElementById('refresh');
if(refreshBtn){
  refreshBtn.addEventListener('click', loadAdsFromGithub);
}

// ğŸ’¡ NEW JAVASCRIPT FOR TICKER TAPE LOGIC
(function(){
  const tickerTape = document.getElementById('tickerTape');
  const tickerItems = tickerTape ? tickerTape.querySelectorAll('.ticker-item') : null;
  
  // Check if the ticker exists and has messages
  if(tickerTape && tickerItems && tickerItems.length > 0){
    // If there are messages, add the class to make it visible
    tickerTape.classList.add('has-messages');
  }
})();
// ğŸ’¡ END OF NEW JAVASCRIPT

/* == */
window.addEventListener('load', async ()=>{ // ØªÙ… Ø¥Ø¶Ø§ÙØ© async
  document.getElementById('home').classList.add('active');
  await loadAdsFromGithub(); // ØªÙ… Ø¥Ø¶Ø§ÙØ© await Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
  openAdFromHash(); // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ hash ÙˆÙØªØ­ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¥Ø°Ø§ ÙˆØ¬Ø¯
  checkAndToggleVisibility(); // ğŸ’¡ NEW: Initial check to hide the message container
});

/* */
window.addEventListener('hashchange', openAdFromHash);
</script>
</body>
</html>
